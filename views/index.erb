<section class="center-vertical">
  <% if @posts.any? %>
    <h1>最新の投稿</h1>
    <% @posts.each do |post| %>
      <div class="post center-vertical">
        <h3><%= post.title %></h3>
        <p><%= post.detail %></p>
        <% if post.items.any? %>
          <div class="items">
            <h4>アイテム一覧</h4>
            <div class="item-grid">
              <% post.items.each do |item| %>
                <div class="item-card">
                  <div class="item-name"><%= item.name %></div>
                  <div class="item-info">
                    <span><%= item.amount %>個</span> |
                    <span><%= item.detail %></span>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
        <% if session[:user_id] %>
        <div class="button-grid">
          <form action="/posts/<%= post.id %>/<%= post.likes.find_by(user_id: session[:user_id]) ? "unlike" : "like" %>" method="post" class="like-form">
            <button type="submit" class="like-button">
              <%= post.likes.find_by(user_id: session[:user_id]) ? "♥ いいね解除" : "♡ いいね" %>
            </button>
          </form>
          <form action="/posts/<%= post.id %>/<%= post.mylists.find_by(user_id: session[:user_id]) ? "remove_mylist" : "add_mylist" %>" method="post" class="like-form">
            <button type="submit" class="like-button">
              <%= post.mylists.find_by(user_id: session[:user_id]) ? "保存解除" : "保存する" %>
            </button>
          </form>
        </div>
        <% end %>
        <p class="like-count">♥ <%= post.likes.count %> 件</p>
      </div>
    <% end %>
  <% else %>
    <p>投稿がありません</p>
  <% end %>
</section>

<% if session[:user_id] %>
  <a href="/create_post" class="fab-post-button">
    ＋
  </a>
<% end %>